<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>Middleware（中间件）之道 - CatchZeng的技术博客 | CatchZeng's Blog</title>

    <link rel="canonical" href="http://localhost:4000/2018/09/25/Middleware-%E4%B8%AD%E9%97%B4%E4%BB%B6-%E4%B9%8B%E9%81%93/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href=" /css/bootstrap.min.css ">

    <!-- Custom CSS -->
    <link rel="stylesheet" href=" /css/hux-blog.min.css ">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href=" /css/syntax.css ">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>

<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">CatchZeng's Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/post-bg-ios.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/post-bg-ios.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#设计模式" title="设计模式">设计模式</a>
                        
                    </div>
                    <h1>Middleware（中间件）之道</h1>
                    
                    
                    <h2 class="subheading">设计模式</h2>
                    
                    <span class="meta">Posted by CatchZeng on September 25, 2018</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<p><span id="busuanzi_container_page_pv"></span></p>

<h2 id="一前言">一、前言</h2>

<p>在日常开发中，我们经常遇到逻辑复杂的业务，导致代码写得又长又乱。有些逻辑像一个流程，在不同的节点需要做不同的操作。
比如，我们经常会遇到上传文件的业务。该业务要求先验证文件正确性，然后上传，最后跳转到成功的页面。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if  checkFile {
    uploadFile  { result
            if result {
                  showSuccessView { result
                             if result {
                                  //handle success
                             } else {
                                  //handle error
                              }
                  }
            } else {
               //TODO handle error
            }
    }
} else {
  //TODO handle error
}
</code></pre></div></div>

<p>我们可以看到伪代码中呈现着<strong>回调地狱</strong>，上传前、上传、上传后的操作逻辑也零散地分布，很容易造成阅读和维护困难，而<strong>中间件</strong>的出现，让我们处理这类业务变得简单很多。</p>

<p>在讲中间件之前我们先来回顾下 AOP。</p>

<h2 id="二aop">二、AOP</h2>

<p>AOP 意为面向切面编程。 以页面统计为例，先来看下传统的流程。</p>

<p><img src="/img/in-post/post-design-pattern/middleware-1.png" alt="" /></p>

<p>我们可以把方框里的流程合为一个，另外系统还会有其他页面统计流程，我们先把这些流程放到一起：</p>

<p><img src="/img/in-post/post-design-pattern/middleware-2.png" alt="" /></p>

<p>不难发现每个页面都有一个相同的页面统计流程。这样的处理有如下几个问题：</p>

<ul>
  <li><strong>重复代码</strong>：每个界面都需要加入页面统计的代码</li>
  <li><strong>影响主流程的清晰度</strong>：页面统计跟<strong>主流程</strong>无关，但又需要加入到各个界面中</li>
  <li><strong>扩展性差</strong>：新增一个界面，就得为其加入页面统计的代码</li>
</ul>

<p>有没有想过把这个页面统计的代码是提取出来，不放到主流程里去呢？这就是 AOP 的思想了，传统的流程讲究<strong>从上而下</strong>的处理流程 ，而 AOP 讲究<strong>“面”</strong>,从<strong>横向切面</strong>将相同的流程提取出去，所以也叫<strong>“横切面”</strong>，如下图所示。</p>

<p><img src="/img/in-post/post-design-pattern/middleware-3.png" alt="" /></p>

<p>AOP 提倡从横向切面思路向管道某个位置插入一段代码逻辑，这样就实现在任何业务<strong>逻辑前后</strong>都有相同代码逻辑段，开发者只需专注写业务逻辑，既不影响主流程，而且隔离了业务逻辑，达到<strong>高内聚低耦合</strong>。</p>

<p>附上 iOS 使用 AOP 实现页面统计的代码，帮助大家理解 AOP。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@implementation UIViewController (Analytics)

+ (void)load{
    [self swizzleInstanceMethod:@selector(viewWillAppear:) with:@selector(swizzled_viewWillAppear:)];
    [self swizzleInstanceMethod:@selector(viewWillDisappear:) with:@selector(swizzled_viewWillDisappear:)];
}

- (void)swizzled_viewWillAppear:(BOOL)animated{
    [self swizzled_viewWillAppear:animated];
    [Analytics beginTimingEvent: self.className];
}

- (void)swizzled_viewWillDisappear:(BOOL)animated{
    [self swizzled_viewWillDisappear:animated];
    [Analytics endTimingEvent: self.className];
}
</code></pre></div></div>

<h3 id="思考">思考</h3>

<ul>
  <li>
    <p>AOP 和 OOP 是什么关系？有什么区别？
写多了 OOP 的代码，会发现 AOP 跟 OOP 的思路不同。OOP 是将做<strong>同一件事情的业务逻辑</strong>封装成一个对象。但是，在做一件事情过程（主流程）中又想做别的事情（比如页面统计）对 OOP 来说难以解决。而 AOP 的出现让 OOP 代码能专注于主流程，更好地遵循<a href="http://catchzeng.com/2017/02/19/聊聊设计模式原则-一-单一职责原则/">单一职责原则</a>，提高内聚性。所以，我认为 AOP 对 OOP 做了一个补充。</p>
  </li>
  <li>
    <p>怎么判断代码是否达到了高内聚？
这个问题吊一下大家胃口，这里先不解答，大家可以在留言处评论，后续会贴出个人的理解。</p>
  </li>
  <li>
    <p>AOP 思想如何解决上传文件的业务的问题？
由于 JavaScript 的动态性较好，下面以 JavaScript 代码为例，看下如何利用 AOP 优化上传文件业务。</p>
  </li>
</ul>

<h3 id="利用-aop-优化上传文件业务">利用 AOP 优化上传文件业务</h3>

<p>AOP 从横向切面思路向管道<strong>某个位置</strong>插入一段代码逻辑。而这个位置通常就是<strong>调用前</strong>（before）和<strong>调用后</strong>（after）。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Function.prototype.before = function(fn){
  var self = this;
   return function(){
     var res = fn.call(this);
     if(res) {
        self.apply(this, arguments);
     }
   }
}

Function.prototype.after = function(fn){
  var self = this;
   return function(){
     self.apply(this, arguments);
     fn.call(this);
   }
}
</code></pre></div></div>

<p>有了这两个扩展，可以按下面的方式实现上传业务。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function checkFile(){
   console.log('checking file');
   if fileIsVaild() {
      return true
   } else {
      console.log('file is invalid');
      return false
    }
}

function uploadFile() {
  console.log('uploading file');
  if fileUploadSuccess() {
      return true
   } else {
      console.log('file upload failed');
      return false
   }
}

function showSuccessView() {
  console.log('show success view');
}

uploadFile.before(checkFile).after(showSuccessView)();
</code></pre></div></div>

<h3 id="思考-1">思考</h3>

<ul>
  <li>
    <p>使用 AOP 后解决了什么问题？还有什么问题？
从上面的例子，可以看出 AOP 已经实现了业务隔离。但却带来了一串长长的<strong>链式调用</strong>，如果处理不当很容易<strong>掉链子</strong>。另外，这种结构实现<strong>异步操作</strong>较为麻烦。</p>
  </li>
  <li>
    <p>有什么办法，既能隔离业务，又能清爽地使用？
这时候，我们的主角就该上场了。</p>
  </li>
</ul>

<h2 id="三中间件">三、中间件</h2>

<p>为了理解中间件，我们来看下<a href="https://koajs.com/#introduction">Koa</a>的中间件使用。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const logger = (ctx, next) =&gt; {
  console.log(`${Date.now()} ${ctx.request.method} ${ctx.request.url}`);
  next();
}
app.use(logger);
</code></pre></div></div>

<p>像上面代码中的 logger 函数就叫做”中间件”（middleware），因为它处在 HTTP Request 和 HTTP Response 中间，用来实现某种中间功能。app.use()用来加载中间件。</p>

<h3 id="中间件栈">中间件栈</h3>

<p>多个中间件会形成一个栈结构（middle stack），以”先进后出”（first-in-last-out）的顺序执行，被称为<strong>洋葱结构</strong>。</p>

<p><img src="/img/in-post/post-design-pattern/middleware-4.png" alt="" /></p>

<p>举个例子</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const one = (ctx, next) =&gt; {
  console.log('&gt;&gt; one');
  next();
  console.log('&lt;&lt; one');
}

const two = (ctx, next) =&gt; {
  console.log('&gt;&gt; two');
  next();
  console.log('&lt;&lt; two');
}

const three = (ctx, next) =&gt; {
  console.log('&gt;&gt; three');
  next();
  console.log('&lt;&lt; three');
}

app.use(one);
app.use(two);
app.use(three);

/*result
&gt;&gt; one
&gt;&gt; two
&gt;&gt; three
&lt;&lt; three
&lt;&lt; two
&lt;&lt; one
*/
</code></pre></div></div>

<p>中间件一个奇妙的点在于<strong>next 函数</strong>。如果中间件内部没有调用 next 函数，那么执行权就不会传递下去。</p>

<h3 id="中间件的实现">中间件的实现</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>export default class MiddlewareCenter {
    constructor() {
        this._middlewares = []
        this._context = null
    }

    use(middleware) {
        if (typeof middleware != 'function') {
            console.warn('middleware must be a function.')
            return null
        }
        this._middlewares.push(middleware)
        return this
    }

    handleRequest(context) {
        const fn = compose(this._middlewares)
        this._context = context
        fn(this._context)
    }
}

function compose(middleware) {
    if (!Array.isArray(middleware)) throw new TypeError('Middleware stack must be an array!')

    for (const fn of middleware) {
        if (typeof fn !== 'function') throw new TypeError('Middleware must be composed of functions!')
    }

    /**
     * @param {Object} context
     * @return {Promise}
     * @api public
     */
    return function (context, next) {
        // last called middleware #
        let index = -1

        return dispatch(0)

        function dispatch(i) {
            if (i &lt;= index) return Promise.reject(new Error('next() called multiple times'))
            index = i

            let fn = middleware[i]
            if (i === middleware.length) fn = next
            if (!fn) return Promise.resolve()
            try {
                return Promise.resolve(fn(context, dispatch.bind(null, i + 1)))
            } catch (err) {
                return Promise.reject(err)
            }
        }
    }
}
</code></pre></div></div>

<p>详细的代码可以看我的开源项目<a href="https://github.com/CatchZeng/middleware-center">middleware-center</a>。</p>

<h3 id="利用中间件优化上传业务">利用中间件优化上传业务</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>const middlewareCenter = new UploadFileCenter()
middlewareCenter.handle('uploader')

/* result
beforeUpload
startUplaod
finishUpload
after finishUpload
after startUplaod
after beforeUpload
*/
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class UploadFileCenter extends MiddlewareCenter {

    constructor() {
        super()
        this._middlewareMap = { 'uploader': [this.beforeUpload, this.startUplaod, this.finishUpload] }
        this.content = ""
    }

    handle(name) {
        let middlewares = this._middlewareMap[name]
        for (let middleware of middlewares) {
            this.use(middleware)
        }
        this.handleRequest(this)
    }

    // Middlewares

    async beforeUpload (ctx, next) {
        console.log('beforeUpload')
        ctx.content = await ctx.genContent()
        await next()
        console.log('after beforeUpload')
    }

    async startUplaod (ctx, next) {
        console.log('startUplaod')
        let result = await ctx.upload(ctx.content)
        await next()
        console.log('after startUplaod')
    }

    finishUpload (ctx, next) {
        console.log('finishUpload')
        //do something like notify listeners
        console.log('after finishUpload')
    }

    // Helpers
    genContent() {
        return new Promise((resolve, reject) =&gt; {
            setTimeout(function () {
                resolve('upload content')
            }, 3)
        })
    }

    upload(content) {
        return new Promise((resolve, reject) =&gt; {
            setTimeout(function () {
                resolve(true)
            }, 5)
        })
    }
}
</code></pre></div></div>

<p>大家可以看到，利用中间件不但可以实现业务隔离，调用也很清晰，只要<strong>根据业务调整 use 的顺序</strong>即可。各个中间件还可以<strong>随意组合，各组件间也没有依赖关系，自身内聚性高</strong>。细心的朋友可以发现，<a href="https://github.com/CatchZeng/middleware-center">middleware-center</a> 还支持<strong>异步方法</strong>。得益于中间件的洋葱结构，使得使用者可以处理业务的任何“位置”（如：beforeUpload、startUplaod、finishUpload、after finishUpload、after startUplaod、after beforeUpload）</p>

<h3 id="遍地开花">遍地开花</h3>

<p>好思想应该遍地开花，业余时间我用 swift 简单实现了中间件模型<a href="https://github.com/CatchZeng/MiddlewareCenter">MiddlewareCenter</a>，但还没优化，和处理引用问题，感兴趣的朋友可以一起维护。</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class ViewController: UIViewController {

    let center = MiddlewareCenter()

    override func viewDidLoad() {
        super.viewDidLoad()

        center.use(BeforeUpload())
        center.use(StartUpload())
        center.use(EndUpload())

        center.handle(ctx: nil)
    }
}

public class StartUpload: Middleware {
    public override func execute() {
        print("before StartUpload.")
        next?.execute()
        print("after StartUpload.")
    }
}

public class BeforeUpload: Middleware {
    public override func execute() {
        print("before upload.")
        next?.execute()
        print("after upload.")
    }
}

public class EndUpload: Middleware {
    public override func execute() {
        print("before EndUpload.")
        next?.execute()
        print("after EndUpload.")
    }
}
</code></pre></div></div>

<h2 id="四总结">四、总结</h2>

<p>中间件实现了业务隔离，满足每个业务所需的数据，又能很好控制业务<strong>下发执行</strong>的权利，所以“中间件”模式算是一种不错的设计。
理解中间件，主要理解三个概念，包括：context、next、洋葱结构。context 为业务所需的上下文，比如 koa 是处理网络请求的，所以它的 context 包含 request、response；next 是业务流的下发控制，使用好 next，可以灵活地处理各种业务，包括错误处理、中间件重用等；洋葱结构可以让使用者轻松地处理各个流程的“位置”。</p>

<p><span id="busuanzi_container_page_pv">
本文总阅读量<span id="busuanzi_value_page_pv"></span>次
</span></p>


                <hr>

                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2018/08/22/Learning-OpenCV-with-iOS-%E5%9B%BE%E5%83%8F%E6%A8%A1%E7%B3%8A-%E9%9D%9E%E7%BA%BF%E6%80%A7%E6%BB%A4%E6%B3%A2/" data-toggle="tooltip" data-placement="top" title="Learning OpenCV with iOS：图像模糊--非线性滤波">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2018/12/12/%E8%A2%AB%E8%BD%BB%E8%A7%86%E7%9A%84%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90/" data-toggle="tooltip" data-placement="top" title="被轻视的持续集成">Next Post &rarr;</a>
                    </li>
                    
                </ul>


                

                
                <!-- disqus 评论框 start -->
                <div class="comment">
                    <div id="disqus_thread" class="disqus-thread"></div>
                </div>
                <!-- disqus 评论框 end -->
                

            </div>

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#Policy" title="Policy" rel="1">
                                    Policy
                                </a>
                            
        				
                            
                				<a href="/tags/#早期文章" title="早期文章" rel="1">
                                    早期文章
                                </a>
                            
        				
                            
                				<a href="/tags/#iOS" title="iOS" rel="4">
                                    iOS
                                </a>
                            
        				
                            
                				<a href="/tags/#CI&CD" title="CI&CD" rel="2">
                                    CI&CD
                                </a>
                            
        				
                            
                				<a href="/tags/#设计模式" title="设计模式" rel="4">
                                    设计模式
                                </a>
                            
        				
                            
                				<a href="/tags/#Clean Code" title="Clean Code" rel="1">
                                    Clean Code
                                </a>
                            
        				
                            
                				<a href="/tags/#JS" title="JS" rel="3">
                                    JS
                                </a>
                            
        				
                            
                				<a href="/tags/#OpenCV" title="OpenCV" rel="6">
                                    OpenCV
                                </a>
                            
        				
                            
                				<a href="/tags/#Android" title="Android" rel="1">
                                    Android
                                </a>
                            
        				
                            
                				<a href="/tags/#Go" title="Go" rel="1">
                                    Go
                                </a>
                            
        				
                            
                				<a href="/tags/#DevOps" title="DevOps" rel="1">
                                    DevOps
                                </a>
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://echowxsy.com/">Echowxsy's Blog</a></li>
                    
                        <li><a href="https://suquanlin.github.io">Shero's Blog</a></li>
                    
                        <li><a href="http://callblueday.com">callblueday's blog</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>





<!-- disqus 公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "catchzeng";
    var disqus_identifier = "/2018/09/25/Middleware（中间件）之道";
    var disqus_url = "http://localhost:4000/2018/09/25/Middleware-%E4%B8%AD%E9%97%B4%E4%BB%B6-%E4%B9%8B%E9%81%93/";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<!-- disqus 公共JS代码 end -->




<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'always',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    <li>
                        <a href=" /feed.xml ">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                     

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                     
                    <li>
                        <a target="_blank" href="http://weibo.com/u/2167807070">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                      
                    <li>
                        <a target="_blank" href="https://github.com/catchzeng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                     
                    <li>
                        <a target="_blank" href="http://www.jianshu.com/u/8a7c6a927178">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">简</i>
                            </span>
                        </a>
                    </li>
                     
                    <li>
                        <a target="_blank" href="http://xiaozhuanlan.com/catchzeng">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">小专栏</i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; CatchZeng's Blog 2019
                    <br>
                    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
                    <span id="busuanzi_container_site_uv">您是第
                        <span id="busuanzi_value_site_uv"></span>位访客</span>
                    <span id="busuanzi_container_site_uv"></span>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src=" /js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src=" /js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src=" /js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
        var d = document, t = 'script',
            o = d.createElement(t),
            s = d.getElementsByTagName(t)[0];
        o.src = u;
        if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
        s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if ($('#tag_cloud').length !== 0) {
        async("/js/jquery.tagcloud.js", function () {
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: { start: '#bbbbee', end: '#0085a1' },
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
        var $nav = document.querySelector("nav");
        if ($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    // dynamic User by Hux
    var _baId = 'ede41d96392251499c57ebaa6d256c8a';

    // Originial
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script> 


<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
