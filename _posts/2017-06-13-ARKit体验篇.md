---
layout:     post
title:      "ARKit体验篇"
subtitle:   "iOS开发"
date:       2017-06-13 09:38:27
author:     "CatchZeng"
header-img: "img/post-bg-2015.jpg"
tags:
    - iOS
---
<span id="busuanzi_container_page_pv"></span>

## AR简介
**增强现实**（Augmented Reality，简称 AR），是一种实时地计算摄影机影像的位置及角度并加上相应[图像](http://baike.baidu.com/item/%E5%9B%BE%E5%83%8F)的技术，这种技术的目标是在屏幕上把虚拟世界套在现实世界并进行互动。

![AR](http://upload-images.jianshu.io/upload_images/943491-5659bb5ec353b2a4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
![AR](http://upload-images.jianshu.io/upload_images/943491-84e13a4fe5722527.gif?)

iOS 11 引入了 ARKit，这是一个全新的框架，允许开发者轻松地为 iPhone 和 iPad 创建无与伦比的增强现实体验。通过将虚拟对象和虚拟信息同用户周围的环境相互融合，ARKit 使得应用跳出屏幕的限制，让它们能够以全新的方式与现实世界进行交互。

## ARKit的优势
* ARKit 大幅降低了开发者在 iOS 上进行 AR 应用开发的难度
* 苹果设备的普及率，使得门槛低，无需其他设备便可体验
* 开发人员可以用苹果的新机器学习框架[CoreML](https://developer.apple.com/documentation/coreml)来识别场景中的对象
* 快速稳定的运动定位
* 平面和边界的估计、光照估计、尺度估计
* 对各个开发平台或引擎的支持（如：Unity3d）

## ARKit体验
废话不多说，先来体验下。当然是有要求的：
* Xcode版本：Xcode9及以上
* iOS系统： iOS11及以上
* iOS设备：处理器A9及以上（6S机型及以上）
* MacOS系统：10.12.4及以上

#### 1.选择Augemnted Reality App
![1](http://upload-images.jianshu.io/upload_images/943491-96e6901c86f1dd41.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

#### 2.填写信息
![2](http://upload-images.jianshu.io/upload_images/943491-daa483ec3e1f57d2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
* 细心的朋友可以看到Content Technology
![Content Technology](http://upload-images.jianshu.io/upload_images/943491-4b4a66fe2fc6b47a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
[Scenekit](https://developer.apple.com/documentation/scenekit)：ARKit框架提供了两种AR技术，一种是基于3D场景(SceneKit)实现的增强现实
[SpriteKit](https://developer.apple.com/documentation/spriteKit)：基于2D场景(SpriktKit)实现的增强现实
[Metal](https://developer.apple.com/metal/)：Apple图形API
Demo中使用3D来构建，所以选择Scenekit

#### 3.Run
![效果](http://upload-images.jianshu.io/upload_images/943491-14612a5de2e955e6.gif?)

## 项目分析
![项目结构](http://upload-images.jianshu.io/upload_images/943491-d8ebceb7a8e3c15d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

```
//在界面上创建ARSCNView，用于展示AR
@IBOutlet var sceneView: ARSCNView!

override func viewDidLoad() {
super.viewDidLoad()

// 设置代理
sceneView.delegate = self

// 显示一些数据，如fps之类的
sceneView.showsStatistics = true

// 创建一个SCNScene，用于显示3d模型
let scene = SCNScene(named: "art.scnassets/ship.scn")!

// 将加载了3d模型的SCNScene设置成ARSCNView的scene
sceneView.scene = scene
}

override func viewWillAppear(_ animated: Bool) {
super.viewWillAppear(animated)

// 为ARSCNView设置一个会话配置类
let configuration = ARWorldTrackingSessionConfiguration()

// 开始session
sceneView.session.run(configuration)
}

override func viewWillDisappear(_ animated: Bool) {
super.viewWillDisappear(animated)

// 暂停session
sceneView.session.pause()
}
```
通过代码分析可以发现，在ARKit中主要有几个类

[ARSCNView](https://developer.apple.com/documentation/arkit/arscnview)：一种显示AR体验的视图，它通过3D SceneKit内容增强了相机视图

[ARWorldTrackingSessionConfiguration](https://developer.apple.com/documentation/arkit/ARWorldTrackingSessionConfiguration): 会话配置类，在配置类对象里设置会话如何将真实的设备运动映射到3D场景的坐标系统里，这里默认是使用重力

[SCNScene](https://developer.apple.com/documentation/scenekit/scnscene): SceneKit 内容的容器. 你可以从3D建模工具生成的文件中加载一个场景，或者用代码创建一个 ，然后把它显示在视图上

## 体验感受
* ARKit API够简单，效果够好。
* 硬件、机器学习[CoreML](https://developer.apple.com/documentation/coreml)和ARkit带来的是满满的惊喜。相信ARKit在未来的时间将会在照片处理，视频，游戏等领域绽放光彩。
